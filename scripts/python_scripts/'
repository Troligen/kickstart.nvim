-- command to adjust table
function CustomCommand()
  -- Save the current visual selection to a temporary file
  local selected_text = vim.fn.getreg('""', 1)
  selected_text = selected_text:gsub("'", "'\\''")

  -- Execute the script/command and capture its output
  local command = string.format("echo '%s' | python3 /path/to/myscript.py", selected_text)

  local output = vim.fn.system(command)

  -- Check if output is non-empty
  if output and output ~= '' then
    -- Replace the selected lines with the output
    vim.api.nvim_command("silent! '<,'>s/.*/" .. output:gsub('\n', '\\n') .. '/')
  else
    vim.api.nvim_err_write 'Error: No output from myscript.py'
  end
end

vim.api.nvim_command [[command! -range CustomCommand <line1>,<line2>lua CustomCommand()]]
